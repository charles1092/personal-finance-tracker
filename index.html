<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50">
    <div id="app" class="p-4">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-4xl font-bold text-slate-800 mb-2">Personal Finance Tracker</h1>
                <p class="text-slate-600">Dynamic financial planning and wealth tracking</p>
            </div>

            <!-- Navigation -->
            <div class="flex space-x-1 mb-6 bg-white rounded-lg p-1 shadow-sm">
                <button onclick="showTab('dashboard')" id="tab-dashboard" class="tab-btn flex items-center space-x-2 px-4 py-2 rounded-md transition-all bg-blue-500 text-white shadow-sm">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="22,7 13.5,15.5 8.5,10.5 2,17"></polyline>
                        <polyline points="16,7 22,7 22,13"></polyline>
                    </svg>
                    <span>Dashboard</span>
                </button>
                <button onclick="showTab('accounts')" id="tab-accounts" class="tab-btn flex items-center space-x-2 px-4 py-2 rounded-md transition-all text-slate-600 hover:bg-slate-100">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="1" x2="12" y2="23"></line>
                        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                    </svg>
                    <span>Accounts</span>
                </button>
                <button onclick="showTab('planning')" id="tab-planning" class="tab-btn flex items-center space-x-2 px-4 py-2 rounded-md transition-all text-slate-600 hover:bg-slate-100">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <span>Planning</span>
                </button>
                <button onclick="showTab('scenarios')" id="tab-scenarios" class="tab-btn flex items-center space-x-2 px-4 py-2 rounded-md transition-all text-slate-600 hover:bg-slate-100">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                    <span>Scenarios</span>
                </button>
                <button onclick="showTab('projections')" id="tab-projections" class="tab-btn flex items-center space-x-2 px-4 py-2 rounded-md transition-all text-slate-600 hover:bg-slate-100">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="22,7 13.5,15.5 8.5,10.5 2,17"></polyline>
                        <polyline points="16,7 22,7 22,13"></polyline>
                    </svg>
                    <span>Projections</span>
                </button>
            </div>

            <!-- Dashboard Tab -->
            <div id="content-dashboard" class="tab-content">
                <div class="space-y-6">
                    <!-- Key Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-sm font-medium text-slate-500">Total Net Worth</h3>
                                <svg class="text-green-500" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="22,7 13.5,15.5 8.5,10.5 2,17"></polyline>
                                    <polyline points="16,7 22,7 22,13"></polyline>
                                </svg>
                            </div>
                            <p id="total-net-worth" class="text-2xl font-bold text-slate-800">$0</p>
                        </div>
                        
                        <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-sm font-medium text-slate-500">Liquid Cash</h3>
                                <svg class="text-blue-500" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="1" x2="12" y2="23"></line>
                                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                                </svg>
                            </div>
                            <p id="liquid-cash" class="text-2xl font-bold text-slate-800">$0</p>
                        </div>
                        
                        <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-sm font-medium text-slate-500">Investments</h3>
                                <svg class="text-purple-500" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="22,7 13.5,15.5 8.5,10.5 2,17"></polyline>
                                    <polyline points="16,7 22,7 22,13"></polyline>
                                </svg>
                            </div>
                            <p id="investments" class="text-2xl font-bold text-slate-800">$0</p>
                        </div>
                        
                        <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-sm font-medium text-slate-500">Available for House</h3>
                                <svg class="text-orange-500" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                            </div>
                            <p id="available-house" class="text-2xl font-bold text-slate-800">$0</p>
                        </div>
                    </div>

                    <!-- Current Month Cash Flow -->
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">This Month's Cash Flow</h3>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="text-center">
                                <p class="text-sm text-slate-500">Income</p>
                                <p id="month-income" class="text-xl font-bold text-green-600">+$0</p>
                            </div>
                            <div class="text-center">
                                <p class="text-sm text-slate-500">Regular Expenses</p>
                                <p id="month-expenses" class="text-xl font-bold text-red-600">-$0</p>
                            </div>
                            <div class="text-center">
                                <p class="text-sm text-slate-500">One-off Events</p>
                                <p id="month-scenarios" class="text-xl font-bold text-slate-600">$0</p>
                            </div>
                            <div class="text-center">
                                <p class="text-sm text-slate-500">Net Flow</p>
                                <p id="month-net" class="text-xl font-bold text-slate-600">$0</p>
                            </div>
                        </div>
                    </div>

                    <!-- House Deposit Projections -->
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">House Deposit Projections</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="text-center p-3 bg-orange-50 rounded-lg">
                                <p class="text-sm text-slate-600">In 6 months</p>
                                <p id="house-6m" class="text-xl font-bold text-orange-600">$0</p>
                            </div>
                            <div class="text-center p-3 bg-orange-50 rounded-lg">
                                <p class="text-sm text-slate-600">In 12 months</p>
                                <p id="house-12m" class="text-xl font-bold text-orange-600">$0</p>
                            </div>
                            <div class="text-center p-3 bg-orange-50 rounded-lg">
                                <p class="text-sm text-slate-600">In 18 months</p>
                                <p id="house-18m" class="text-xl font-bold text-orange-600">$0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Accounts Tab -->
            <div id="content-accounts" class="tab-content hidden">
                <div class="space-y-6">
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">Account Balances</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-slate-700">Up Bank (Cash)</label>
                                <div class="flex space-x-2">
                                    <input type="number" id="account-upBank" oninput="updateAccount('upBank', this.value)" class="flex-1 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
                                    <span id="date-upBank" class="px-3 py-2 text-sm text-slate-500 bg-slate-50 rounded-md">Updated: Today</span>
                                </div>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-slate-700">CommBank Pocket (ETFs)</label>
                                <div class="flex space-x-2">
                                    <input type="number" id="account-commBankPocket" oninput="updateAccount('commBankPocket', this.value)" class="flex-1 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
                                    <span id="date-commBankPocket" class="px-3 py-2 text-sm text-slate-500 bg-slate-50 rounded-md">Updated: Today</span>
                                </div>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-slate-700">Commsec (Shares)</label>
                                <div class="flex space-x-2">
                                    <input type="number" id="account-commsec" oninput="updateAccount('commsec', this.value)" class="flex-1 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
                                    <span id="date-commsec" class="px-3 py-2 text-sm text-slate-500 bg-slate-50 rounded-md">Updated: Today</span>
                                </div>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-slate-700">Stake (USD ETFs)</label>
                                <div class="flex space-x-2">
                                    <input type="number" id="account-stakeUSD" oninput="updateAccount('stakeUSD', this.value)" class="flex-1 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
                                    <span id="date-stakeUSD" class="px-3 py-2 text-sm text-slate-500 bg-slate-50 rounded-md">Updated: Today</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Temporary Assets -->
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-slate-800">Temporary Assets & Money Owed</h3>
                            <button onclick="addTemporaryAsset()" class="flex items-center space-x-2 px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                <span>Add Asset</span>
                            </button>
                        </div>
                        <div id="temporary-assets" class="space-y-3">
                            <p class="text-slate-500 text-center py-4">No temporary assets added yet</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Planning Tab -->
            <div id="content-planning" class="tab-content hidden">
                <div class="space-y-6">
                    <!-- Income Configuration -->
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">Income Configuration</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Monthly Salary</label>
                                <input type="number" id="monthly-salary" oninput="updateIncome()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Annual Bonus</label>
                                <input type="number" id="annual-bonus" oninput="updateIncome()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Bonus Confirmed?</label>
                                <select id="bonus-confirmed" onchange="updateIncome()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="false">No</option>
                                    <option value="true">Yes</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Monthly Expenses -->
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">Monthly Expenses</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Rent</label>
                                <input type="number" id="expense-rent" oninput="updateExpenses()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Utilities</label>
                                <input type="number" id="expense-utilities" oninput="updateExpenses()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Groceries</label>
                                <input type="number" id="expense-groceries" oninput="updateExpenses()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Transport</label>
                                <input type="number" id="expense-transport" oninput="updateExpenses()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Entertainment</label>
                                <input type="number" id="expense-entertainment" oninput="updateExpenses()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Other</label>
                                <input type="number" id="expense-other" oninput="updateExpenses()" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" value="0">
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-slate-50 rounded-lg">
                            <p class="text-sm text-slate-600">
                                Total Monthly Expenses: <span id="total-expenses" class="font-semibold">$0</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scenarios Tab -->
            <div id="content-scenarios" class="tab-content hidden">
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-slate-800">One-off Events & Scenarios</h3>
                        <button onclick="addScenario()" class="flex items-center space-x-2 px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            <span>Add Scenario</span>
                        </button>
                    </div>
                    <div id="scenarios-list" class="space-y-3">
                        <p class="text-slate-500 text-center py-4">No scenarios added yet</p>
                    </div>
                </div>
            </div>

            <!-- Projections Tab -->
            <div id="content-projections" class="tab-content hidden">
                <div class="space-y-6">
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-slate-800">Projection Settings</h3>
                            <div class="flex items-center space-x-2">
                                <label class="text-sm font-medium text-slate-700">Months to project:</label>
                                <select id="projection-months" onchange="updateProjections()" class="px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="6">6 months</option>
                                    <option value="12" selected>12 months</option>
                                    <option value="18">18 months</option>
                                    <option value="24">24 months</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">Monthly Projections</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full table-auto">
                                <thead>
                                    <tr class="border-b border-slate-200">
                                        <th class="text-left py-2 text-sm font-medium text-slate-700">Month</th>
                                        <th class="text-right py-2 text-sm font-medium text-slate-700">Cash</th>
                                        <th class="text-right py-2 text-sm font-medium text-slate-700">Investments</th>
                                        <th class="text-right py-2 text-sm font-medium text-slate-700">Total</th>
                                        <th class="text-right py-2 text-sm font-medium text-slate-700">For House</th>
                                    </tr>
                                </thead>
                                <tbody id="projections-table">
                                    <tr>
                                        <td colspan="5" class="text-center py-4 text-slate-500">Add your financial data to see projections</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global data store
        let appData = {
            accounts: {
                upBank: { balance: 0, lastUpdated: new Date().toISOString().slice(0, 10) },
                commBankPocket: { balance: 0, lastUpdated: new Date().toISOString().slice(0, 10) },
                commsec: { balance: 0, lastUpdated: new Date().toISOString().slice(0, 10) },
                stakeUSD: { balance: 0, lastUpdated: new Date().toISOString().slice(0, 10) }
            },
            income: {
                monthlySalary: 0,
                annualBonus: { amount: 0, confirmed: false }
            },
            expenses: {
                rent: 0, utilities: 0, groceries: 0, transport: 0, entertainment: 0, other: 0
            },
            temporaryAssets: [],
            scenarios: [],
            projectionMonths: 12
        };

        // Load/Save functions
        function loadData() {
            try {
                const saved = localStorage.getItem('financeTrackerData');
                if (saved) {
                    appData = { ...appData, ...JSON.parse(saved) };
                }
            } catch (e) {
                console.error('Failed to load data:', e);
            }
        }

        function saveData() {
            try {
                localStorage.setItem('financeTrackerData', JSON.stringify(appData));
            } catch (e) {
                console.error('Failed to save data:', e);
            }
        }

        // Tab functions
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(el => {
                el.className = 'tab-btn flex items-center space-x-2 px-4 py-2 rounded-md transition-all text-slate-600 hover:bg-slate-100';
            });
            
            // Show selected tab
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            document.getElementById(`tab-${tabName}`).className = 'tab-btn flex items-center space-x-2 px-4 py-2 rounded-md transition-all bg-blue-500 text-white shadow-sm';
        }

        // Account functions
        function updateAccount(accountKey, value) {
            const balance = parseFloat(value) || 0;
            appData.accounts[accountKey] = {
                balance: balance,
                lastUpdated: new Date().toISOString().slice(0, 10)
            };
            document.getElementById(`date-${accountKey}`).textContent = `Updated: ${appData.accounts[accountKey].lastUpdated}`;
            saveData();
            updateDashboard();
        }

        function updateIncome() {
            appData.income.monthlySalary = parseFloat(document.getElementById('monthly-salary').value) || 0;
            appData.income.annualBonus.amount = parseFloat(document.getElementById('annual-bonus').value) || 0;
            appData.income.annualBonus.confirmed = document.getElementById('bonus-confirmed').value === 'true';
            saveData();
            updateDashboard();
        }

        function updateExpenses() {
            const expenseTypes = ['rent', 'utilities', 'groceries', 'transport', 'entertainment', 'other'];
            expenseTypes.forEach(type => {
                appData.expenses[type] = parseFloat(document.getElementById(`expense-${type}`).value) || 0;
            });
            
            const total = Object.values(appData.expenses).reduce((sum, val) => sum + val, 0);
            document.getElementById('total-expenses').textContent = `${total.toLocaleString()}`;
            
            saveData();
            updateDashboard();
        }

        function addTemporaryAsset() {
            const id = Date.now();
            appData.temporaryAssets.push({
                id: id,
                description: "New temporary asset",
                amount: 0,
                returnDate: new Date().toISOString().slice(0, 10)
            });
            saveData();
            renderTemporaryAssets();
            updateDashboard();
        }

        function updateTemporaryAsset(id, field, value) {
            const asset = appData.temporaryAssets.find(a => a.id === id);
            if (asset) {
                if (field === 'amount') {
                    asset[field] = parseFloat(value) || 0;
                } else {
                    asset[field] = value;
                }
                saveData();
                updateDashboard();
            }
        }

        function deleteTemporaryAsset(id) {
            appData.temporaryAssets = appData.temporaryAssets.filter(a => a.id !== id);
            saveData();
            renderTemporaryAssets();
            updateDashboard();
        }

        function addScenario() {
            const id = Date.now();
            appData.scenarios.push({
                id: id,
                description: "New Event",
                amount: 0,
                date: new Date().toISOString().slice(0, 10),
                enabled: true
            });
            saveData();
            renderScenarios();
            updateDashboard();
        }

        function updateScenario(id, field, value) {
            const scenario = appData.scenarios.find(s => s.id === id);
            if (scenario) {
                if (field === 'amount') {
                    scenario[field] = parseFloat(value) || 0;
                } else if (field === 'enabled') {
                    scenario[field] = value;
                } else {
                    scenario[field] = value;
                }
                saveData();
                renderScenarios();
                updateDashboard();
            }
        }

        function deleteScenario(id) {
            appData.scenarios = appData.scenarios.filter(s => s.id !== id);
            saveData();
            renderScenarios();
            updateDashboard();
        }

        function renderTemporaryAssets() {
            const container = document.getElementById('temporary-assets');
            if (appData.temporaryAssets.length === 0) {
                container.innerHTML = '<p class="text-slate-500 text-center py-4">No temporary assets added yet</p>';
                return;
            }

            container.innerHTML = appData.temporaryAssets.map(asset => `
                <div class="flex space-x-3 items-center p-3 bg-slate-50 rounded-lg">
                    <input type="text" value="${asset.description}" onchange="updateTemporaryAsset(${asset.id}, 'description', this.value)" class="flex-1 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="Description">
                    <input type="number" value="${asset.amount}" onchange="updateTemporaryAsset(${asset.id}, 'amount', this.value)" class="w-32 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="Amount">
                    <input type="date" value="${asset.returnDate}" onchange="updateTemporaryAsset(${asset.id}, 'returnDate', this.value)" class="w-40 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500">
                    <button onclick="deleteTemporaryAsset(${asset.id})" class="p-2 text-red-500 hover:bg-red-50 rounded-md">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3,6 5,6 21,6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            <line x1="10" y1="11" x2="10" y2="17"></line>
                            <line x1="14" y1="11" x2="14" y2="17"></line>
                        </svg>
                    </button>
                </div>
            `).join('');
        }

        function renderScenarios() {
            const container = document.getElementById('scenarios-list');
            if (appData.scenarios.length === 0) {
                container.innerHTML = '<p class="text-slate-500 text-center py-4">No scenarios added yet</p>';
                return;
            }

            container.innerHTML = appData.scenarios.map(scenario => `
                <div class="flex space-x-3 items-center p-3 bg-slate-50 rounded-lg">
                    <button onclick="updateScenario(${scenario.id}, 'enabled', ${!scenario.enabled})" class="p-2 rounded-md ${scenario.enabled ? 'text-green-600 bg-green-50' : 'text-slate-400 bg-slate-100'}">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            ${scenario.enabled ? 
                                '<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle>' :
                                '<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line>'
                            }
                        </svg>
                    </button>
                    <input type="text" value="${scenario.description}" onchange="updateScenario(${scenario.id}, 'description', this.value)" class="flex-1 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="Event description">
                    <input type="number" value="${scenario.amount}" onchange="updateScenario(${scenario.id}, 'amount', this.value)" class="w-32 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="Amount">
                    <input type="date" value="${scenario.date}" onchange="updateScenario(${scenario.id}, 'date', this.value)" class="w-40 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500">
                    <button onclick="deleteScenario(${scenario.id})" class="p-2 text-red-500 hover:bg-red-50 rounded-md">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3,6 5,6 21,6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            <line x1="10" y1="11" x2="10" y2="17"></line>
                            <line x1="14" y1="11" x2="14" y2="17"></line>
                        </svg>
                    </button>
                </div>
            `).join('');
        }

        function calculateProjections() {
            const projections = [];
            const today = new Date();
            let runningCash = appData.accounts.upBank.balance;
            let runningInvestments = Object.values(appData.accounts).reduce((sum, acc) => sum + acc.balance, 0) - runningCash;
            
            const monthlyExpenseTotal = Object.values(appData.expenses).reduce((sum, exp) => sum + exp, 0);
            const tempAssetsTotal = appData.temporaryAssets.reduce((sum, asset) => sum + asset.amount, 0);
            
            for (let i = 0; i <= appData.projectionMonths; i++) {
                const projDate = new Date(today.getFullYear(), today.getMonth() + i, 1);
                const monthStr = projDate.toISOString().slice(0, 7);
                
                // Add monthly salary
                runningCash += appData.income.monthlySalary;
                
                // Subtract monthly expenses
                runningCash -= monthlyExpenseTotal;
                
                // Apply scenarios for this month
                const monthScenarios = appData.scenarios.filter(s => 
                    s.enabled && s.date.startsWith(monthStr)
                );
                monthScenarios.forEach(scenario => {
                    runningCash += scenario.amount;
                });
                
                // Add annual bonus if applicable (October)
                if (projDate.getMonth() === 9 && appData.income.annualBonus.confirmed) {
                    runningCash += appData.income.annualBonus.amount;
                }
                
                // Invest excess cash
                if (runningCash > 5000) {
                    const excessCash = runningCash - 5000;
                    runningInvestments += excessCash * 0.8;
                    runningCash = 5000 + (excessCash * 0.2);
                }
                
                const totalWealth = runningCash + runningInvestments + tempAssetsTotal;
                
                projections.push({
                    month: projDate.toLocaleDateString('en-AU', { month: 'short', year: 'numeric' }),
                    cash: Math.round(runningCash),
                    investments: Math.round(runningInvestments),
                    total: Math.round(totalWealth),
                    availableForHouse: Math.round(runningCash + runningInvestments * 0.9)
                });
            }
            
            return projections;
        }

        function updateProjections() {
            appData.projectionMonths = parseInt(document.getElementById('projection-months').value);
            saveData();
            
            const projections = calculateProjections();
            const tableBody = document.getElementById('projections-table');
            
            if (projections.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" class="text-center py-4 text-slate-500">Add your financial data to see projections</td></tr>';
                return;
            }
            
            tableBody.innerHTML = projections.slice(0, 12).map(proj => `
                <tr class="border-b border-slate-100">
                    <td class="py-2 text-sm text-slate-600">${proj.month}</td>
                    <td class="py-2 text-sm text-slate-800 text-right">${proj.cash.toLocaleString()}</td>
                    <td class="py-2 text-sm text-slate-800 text-right">${proj.investments.toLocaleString()}</td>
                    <td class="py-2 text-sm font-semibold text-slate-800 text-right">${proj.total.toLocaleString()}</td>
                    <td class="py-2 text-sm font-semibold text-orange-600 text-right">${proj.availableForHouse.toLocaleString()}</td>
                </tr>
            `).join('');
        }

        function updateDashboard() {
            // Calculate totals
            const accountsTotal = Object.values(appData.accounts).reduce((sum, acc) => sum + acc.balance, 0);
            const tempAssetsTotal = appData.temporaryAssets.reduce((sum, asset) => sum + asset.amount, 0);
            const totalNetWorth = accountsTotal + tempAssetsTotal;
            const liquidCash = appData.accounts.upBank.balance;
            const investments = accountsTotal - liquidCash;
            
            // Update dashboard metrics
            document.getElementById('total-net-worth').textContent = `${totalNetWorth.toLocaleString()}`;
            document.getElementById('liquid-cash').textContent = `${liquidCash.toLocaleString()}`;
            document.getElementById('investments').textContent = `${investments.toLocaleString()}`;
            
            // Calculate current month flow
            const monthlyExpenseTotal = Object.values(appData.expenses).reduce((sum, exp) => sum + exp, 0);
            const currentMonth = new Date().toISOString().slice(0, 7);
            const monthScenarios = appData.scenarios.filter(s => 
                s.enabled && s.date.startsWith(currentMonth)
            ).reduce((sum, s) => sum + s.amount, 0);
            
            const netFlow = appData.income.monthlySalary - monthlyExpenseTotal + monthScenarios;
            
            document.getElementById('month-income').textContent = `+${appData.income.monthlySalary.toLocaleString()}`;
            document.getElementById('month-expenses').textContent = `-${monthlyExpenseTotal.toLocaleString()}`;
            
            const scenarioEl = document.getElementById('month-scenarios');
            scenarioEl.textContent = `${monthScenarios >= 0 ? '+' : ''}${monthScenarios.toLocaleString()}`;
            scenarioEl.className = `text-xl font-bold ${monthScenarios >= 0 ? 'text-green-600' : 'text-red-600'}`;
            
            const netEl = document.getElementById('month-net');
            netEl.textContent = `${netFlow >= 0 ? '+' : ''}${netFlow.toLocaleString()}`;
            netEl.className = `text-xl font-bold ${netFlow >= 0 ? 'text-green-600' : 'text-red-600'}`;
            
            // Calculate and update projections
            const projections = calculateProjections();
            
            document.getElementById('available-house').textContent = `${(projections[0]?.availableForHouse || 0).toLocaleString()}`;
            document.getElementById('house-6m').textContent = `${(projections[6]?.availableForHouse || 0).toLocaleString()}`;
            document.getElementById('house-12m').textContent = `${(projections[12]?.availableForHouse || 0).toLocaleString()}`;
            document.getElementById('house-18m').textContent = `${(projections[18]?.availableForHouse || 0).toLocaleString()}`;
            
            // Update projections table if on that tab
            if (!document.getElementById('content-projections').classList.contains('hidden')) {
                updateProjections();
            }
        }

        function populateFields() {
            // Populate account fields
            Object.keys(appData.accounts).forEach(key => {
                const input = document.getElementById(`account-${key}`);
                const dateEl = document.getElementById(`date-${key}`);
                if (input) {
                    input.value = appData.accounts[key].balance;
                    dateEl.textContent = `Updated: ${appData.accounts[key].lastUpdated}`;
                }
            });
            
            // Populate income fields
            document.getElementById('monthly-salary').value = appData.income.monthlySalary;
            document.getElementById('annual-bonus').value = appData.income.annualBonus.amount;
            document.getElementById('bonus-confirmed').value = appData.income.annualBonus.confirmed;
            
            // Populate expense fields
            Object.keys(appData.expenses).forEach(key => {
                const input = document.getElementById(`expense-${key}`);
                if (input) input.value = appData.expenses[key];
            });
            
            // Update totals
            updateExpenses();
            
            // Populate projection settings
            document.getElementById('projection-months').value = appData.projectionMonths;
        }

        // Initialize app
        function initApp() {
            loadData();
            populateFields();
            renderTemporaryAssets();
            renderScenarios();
            updateDashboard();
            console.log('Finance Tracker loaded successfully!');
        }

        // Start the app when page loads
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
